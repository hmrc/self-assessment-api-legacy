{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Tax Calculation output for Income Tax Calculation",
  "type": "object",
  "properties": {
    "calcOutput": {
      "$ref": "#/definitions/calcOutputObject",
      "description": "The calculation output JSON"
    }
  },
  "required": [
    "calcOutput"
  ],
  "additionalProperties": false,
  "definitions": {
    "calcOutputObject": {
      "type": "object",
      "properties": {
        "calcName": {
          "description": "The logical name of the calculator (e.g. meta data from the calculator)",
          "type": "string",
          "minLength": 1,
          "maxLength": 32
        },
        "calcVersion": {
          "description": "The version number of the calculation (meta data from the calculator)",
          "type": "string",
          "minLength": 1,
          "maxLength": 10
        },
        "calcVersionDate": {
          "$ref": "#/definitions/dateString",
          "description": "Date the calculator version became active (meta data from the calculator)"
        },
        "calcID": {
          "$ref": "#/definitions/calcId",
          "description": "The calculation ID – an 8 digit number with leading zeros that is unique to the identifier in the calculation input"
        },
        "sourceName": {
          "description": "The name of the source system that requested the calculation",
          "type": "string",
          "minLength": 1,
          "maxLength": 32
        },
        "sourceRef": {
          "description": "Internal reference from source system (for traceability purposes)",
          "type": "string",
          "minLength": 1,
          "maxLength": 32
        },
        "identifier": {
          "description": "Identifies the entity for whom the calculation was performed (as supplied in calculation request)",
          "type": "string",
          "minLength": 1,
          "maxLength": 16
        },
        "year": {
          "description": "This identifies the Tax Year to which the calculation relates in the format yyyy. NB. this is the ending year (e.g. Tax Year 2017-2018 would be expressed as 2018)",
          "type": "number",
          "minimum": 2016,
          "maximum": 2099
        },
        "periodFrom": {
          "$ref": "#/definitions/dateString",
          "description": "This defines the earliest point from which the calculation was performed. This will be the Accounting period start date (for self-employments) or the tax year start date, whichever occurs first."
        },
        "periodTo": {
          "$ref": "#/definitions/dateString",
          "description": "This defines the latest point to which the calculation was performed and will be the point in the year to which income has been received."
        },
        "calcAmount": {
          "$ref": "#/definitions/monetaryPosNeg",
          "description": "The high level calculated amount.  For Income Tax this is the year to date total amount of Income Tax and national Insurance."
        },
        "calcTimestamp": {
          "$ref": "#/definitions/timestampString",
          "description": "Timestamp of when the calculation was performed"
        },
        "calcResult": {
          "$ref": "#/definitions/calcResultObject",
          "description": "An object containing the calculated result (this will be bespoke to the calcName)"
        }
      },
      "required": [
        "calcName",
        "calcVersion",
        "calcVersionDate",
        "calcID",
        "sourceName",
        "sourceRef",
        "identifier",
        "year",
        "periodFrom",
        "periodTo",
        "calcAmount",
        "calcTimestamp",
        "calcResult"
      ],
      "additionalProperties": false
    },
    "calcResultObject": {
      "type": "object",
      "properties": {
        "incomeTaxNicYtd": {
          "$ref": "#/definitions/monetaryPosNeg",
          "description": "Total of calculated Income Tax and National Insurance"
        },
        "incomeTaxNicDelta": {
          "$ref": "#/definitions/monetaryPosNeg",
          "description": "Difference between the total of calculated Income Tax and National Insurance in this calculation and the previous calculation performed"
        },
        "crystallised": {
          "description": "Indicates if the data represents the crystallised position for the Tax Year; if N then it is Year to Date",
          "type": "boolean"
        },
        "nationalRegime": {
          "description": "This defines the national tax rates and rules to be applied. Values are UK and Scotland, May Change in future",
          "enum": [
            "UK",
            "Scotland"
          ]
        },
        "totalTaxableIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total Taxable Income. This is Total Income Received less the Total of Allowances and Deductions"
        },
        "taxableIncome": {
          "$ref": "#/definitions/taxableIncomeObject",
          "description": "An object breaking down how taxable income is derived"
        },
        "totalIncomeTax": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total calculated Income Tax after allowances and reliefs"
        },
        "incomeTax": {
          "$ref": "#/definitions/incomeTaxObject",
          "description": "An object detailing the calculation of Income Tax"
        },
        "totalNic": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total Calculated National Insurance Contributions"
        },
        "nic": {
          "$ref": "#/definitions/nicObject",
          "description": "An object detailing the calculation of National Insurance Contributions"
        },
        "eoyEstimate": {
          "$ref": "#/definitions/eoyEstimateObject",
          "description": "An object containing end of year estimates"
        },
        "msgCount": {
          "description": "Count of messages",
          "type": "number"
        },
        "msg": {
          "$ref": "#/definitions/msgArray",
          "description": "An array of messages"
        },
        "previousCalc": {
          "$ref": "#/definitions/previousCalcObject",
          "description": "An object detailing the previous calculation (used to derive the delta calculation)"
        },
        "annualAllowances": {
          "$ref": "#/definitions/annualAllowancesObject",
          "description": "An object defining annual allowances"
        }
      },
      "required": [
        "incomeTaxNicYtd",
        "incomeTaxNicDelta",
        "crystallised",
        "nationalRegime",
        "totalTaxableIncome",
        "taxableIncome",
        "totalIncomeTax",
        "incomeTax",
        "totalNic",
        "nic",
        "msgCount",
        "annualAllowances"
      ],
      "additionalProperties": false
    },
    "taxableIncomeObject": {
      "type": "object",
      "properties": {
        "totalIncomeReceived": {
          "$ref": "#/definitions/monetaryPos",
          "description": "The total of income received"
        },
        "incomeReceived": {
          "$ref": "#/definitions/incomeReceivedObject",
          "description": "An object breaking down income received by income sources"
        },
        "totalAllowancesAndDeductions": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total of allowances and deductions"
        },
        "allowancesAndDeductions": {
          "$ref": "#/definitions/allowancesAndDeductionsObject",
          "description": "An object detailing allowances and deductions"
        }
      },
      "required": [
        "totalIncomeReceived",
        "totalAllowancesAndDeductions",
        "allowancesAndDeductions"
      ],
      "additionalProperties": false
    },
    "incomeReceivedObject": {
      "type": "object",
      "properties": {
        "employmentIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total employment income across all employments"
        },
        "employments": {
          "$ref": "#/definitions/employmentsIncomeObject",
          "description": "An object detailing employment income"
        },
        "shareSchemeIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Taxable income from share schemes"
        },
        "shareSchemes": {
          "$ref": "#/definitions/incomeSourceObject",
          "description": "An object containing share scheme information"
        },
        "selfEmploymentIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total taxable profit for all self employments"
        },
        "selfEmployment": {
          "$ref": "#/definitions/selfEmploymentIncomeArray",
          "description": "An array of self employment income"
        },
        "partnershipIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total taxable income from partnerships"
        },
        "partnership": {
          "$ref": "#/definitions/partnershipIncomeArray",
          "description": "An array of partnership source income"
        },
        "ukPropertyIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Profit from UK land and property"
        },
        "ukProperty": {
          "$ref": "#/definitions/ukPropertyIncomeObject",
          "description": "An object containing UK property income data"
        },
        "foreignIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Amount of taxable foreign income"
        },
        "foreign": {
          "$ref": "#/definitions/incomeSourceObject",
          "description": "An object detailing foreign income"
        },
        "foreignDividendIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Amount of taxable income from foreign dividends"
        },
        "foreignDividends": {
          "$ref": "#/definitions/incomeSourceObject",
          "description": "An object detailing foreign dividends"
        },
        "trustsIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Amount of taxable income from trust and estates"
        },
        "trusts": {
          "$ref": "#/definitions/incomeSourceObject",
          "description": "An object detailing trust and estate income"
        },
        "bbsiIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "The amount of Interest from UK banks, building societies and securities etc"
        },
        "bbsi": {
          "$ref": "#/definitions/bbsiObject",
          "description": "An object detailing sources of bank and building society interest"
        },
        "ukDividendIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Amount of taxable income from dividends from UK companies"
        },
        "ukDividends": {
          "$ref": "#/definitions/incomeSourceObject",
          "description": "An object detailing UK dividend income"
        },
        "ukPensionsIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Amount of taxable UK pensions and state benefits"
        },
        "ukPensions": {
          "$ref": "#/definitions/incomeSourceObject",
          "description": "An object detailing pensions and state benefit source"
        },
        "gainsOnLifeInsuranceIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Amount of taxable gains on life insurance policies etc."
        },
        "gainsOnLifeInsurance": {
          "$ref": "#/definitions/incomeSourceObject",
          "description": "An object detailing source for gains of life insurance"
        },
        "otherIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Other taxable income"
        }
      },
      "additionalProperties": false
    },
    "employmentsIncomeObject": {
      "type": "object",
      "properties": {
        "totalPay": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Net pay from all Employments"
        },
        "totalBenefitsAndExpenses": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total of Benefits and Expenses from all employments"
        },
        "totalAllowableExpenses": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total allowable expenses across all employments"
        },
        "employment": {
          "$ref": "#/definitions/employmentIncomeArray",
          "description": "An array for each employment"
        }
      },
      "required": [
        "totalPay",
        "totalBenefitsAndExpenses",
        "totalAllowableExpenses",
        "employment"
      ],
      "additionalProperties": false
    },
    "employmentIncomeArray": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "incomeSourceID": {
            "description": "Identifies the employment",
            "type": "string"
          },
          "latestDate": {
            "$ref": "#/definitions/dateString",
            "description": "latest date for which income data has been supplies"
          },
          "netPay": {
            "$ref": "#/definitions/monetaryPos",
            "description": "The net pay YTD for the employment"
          },
          "benefitsAndExpenses": {
            "$ref": "#/definitions/monetaryPos",
            "description": "Benefits and expenses relating to the employment"
          },
          "allowableExpenses": {
            "$ref": "#/definitions/monetaryPos",
            "description": "Allowable expenses relating to the employment"
          }
        },
        "required": [
          "incomeSourceID",
          "latestDate",
          "netPay",
          "benefitsAndExpenses",
          "allowableExpenses"
        ],
        "additionalProperties": false
      }
    },
    "selfEmploymentIncomeArray": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "incomeSourceID": {
            "description": "Identifies the self-employment income source",
            "type": "string"
          },
          "latestDate": {
            "$ref": "#/definitions/dateString",
            "description": "the latest date to which source data applies"
          },
          "accountStartDate": {
            "$ref": "#/definitions/dateString",
            "description": "the accounting period start date"
          },
          "accountEndDate": {
            "$ref": "#/definitions/dateString",
            "description": "the accounting period end date"
          },
          "taxableIncome": {
            "$ref": "#/definitions/monetaryPos",
            "description": "the taxable profit from the self-employment"
          },
          "finalised": {
            "description": "Indicates if the taxable income for this self-employment is finalised",
            "type": "boolean"
          }
        },
        "required": [
          "incomeSourceID",
          "latestDate",
          "taxableIncome"
        ],
        "additionalProperties": false
      }
    },
    "partnershipIncomeArray": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "incomeSourceID": {
            "description": "Source identifier",
            "type": "string"
          },
          "latestDate": {
            "$ref": "#/definitions/dateString",
            "description": "the latest date to which source data applies"
          },
          "taxableIncome": {
            "$ref": "#/definitions/monetaryPos",
            "description": "the amount of taxable income from the partnership"
          }
        },
        "required": [
          "incomeSourceID",
          "latestDate",
          "taxableIncome"
        ],
        "additionalProperties": false
      }
    },
    "ukPropertyIncomeObject": {
      "type": "object",
      "properties": {
        "incomeSourceID": {
          "description": "Source identifier",
          "type": "string"
        },
        "latestDate": {
          "$ref": "#/definitions/dateString",
          "description": "the latest date to which source data applies"
        },
        "taxableProfit": {
          "$ref": "#/definitions/monetaryPos",
          "description": "taxable profit for property"
        },
        "taxableProfitFhlUk": {
          "$ref": "#/definitions/monetaryPos",
          "description": "taxable profit for UK furnished holiday lettings"
        },
        "taxableProfitFhlEea": {
          "$ref": "#/definitions/monetaryPos",
          "description": "taxable profit for EEA furnished holiday lettings"
        },
        "finalised": {
          "description": "Indicates if the taxable income for all UK property is finalised",
          "type": "boolean"
        }
      },
      "required": [
        "latestDate"
      ],
      "additionalProperties": false
    },
    "incomeSourceObject": {
      "type": "object",
      "properties": {
        "incomeSourceID": {
          "description": "Source identifier",
          "type": "string"
        },
        "latestDate": {
          "$ref": "#/definitions/dateString",
          "description": "the latest date to which source data applies"
        }
      },
      "required": [
        "incomeSourceID",
        "latestDate"
      ],
      "additionalProperties": false
    },
    "bbsiObject": {
      "type": "object",
      "properties": {
        "incomeSourceID": {
          "description": "Source identifier",
          "type": "string"
        },
        "latestDate": {
          "$ref": "#/definitions/dateString",
          "description": "the latest date to which source data applies"
        },
        "interestReceived": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Interest received"
        }
      },
      "required": [
        "incomeSourceID",
        "latestDate",
        "interestReceived"
      ],
      "additionalProperties": false
    },
    "allowancesAndDeductionsObject": {
      "type": "object",
      "properties": {
        "paymentsIntoARetirementAnnuity": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Payments into a retirement annuity contract etc."
        },
        "foreignTaxOnEstates": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Foreign tax on estates (tax credit relief not claimed)"
        },
        "incomeTaxRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Income tax relief"
        },
        "annuities": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Annuities"
        },
        "giftOfInvestmentsAndPropertyToCharity": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Gift of investments and property to charity"
        },
        "apportionedPersonalAllowance": {
          "$ref": "#/definitions/monetaryPos",
          "description": "The apportioned Personal Allowance from annual allowance or reduced personal allowance (if applicable)"
        },
        "marriageAllowanceTransfer": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Marriage Allowance transfer"
        },
        "blindPersonAllowance": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Blind Person's Allowance"
        },
        "blindPersonSurplusAllowanceFromSpouse": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Blind Person's surplus allowance from spouse"
        },
        "incomeExcluded": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Income excluded from this calculation"
        }
      },
      "required": [
        "apportionedPersonalAllowance"
      ],
      "additionalProperties": false
    },
    "incomeTaxObject": {
      "type": "object",
      "properties": {
        "totalBeforeReliefs": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total Income tax before allowances and reliefs and deductionsare applied"
        },
        "taxableIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "The total income subject to Income Tax calculation"
        },
        "payPensionsProfit": {
          "$ref": "#/definitions/incomeTaxCategoryObject",
          "description": "An object containing data to the calculation of income tax against Pay Pensions and profit"
        },
        "savingsAndGains": {
          "$ref": "#/definitions/incomeTaxCategoryObject",
          "description": "An object containing tax band data for savings interest from banks or building societies, securities and gains on life policies"
        },
        "dividends": {
          "$ref": "#/definitions/incomeTaxCategoryObject",
          "description": "An object containing data to the calculation of income tax against dividend income"
        },
        "excludedIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Tax on excluded income"
        },
        "totalAllowancesAndReliefs": {
          "$ref": "#/definitions/monetaryPos",
          "description": "The total of allowances and reliefs"
        },
        "allowancesAndReliefs": {
          "$ref": "#/definitions/allowancesAndReliefsObject",
          "description": "An object containing the allowances and reliefs applied"
        }
      },
      "required": [
        "totalBeforeReliefs",
        "taxableIncome",
        "totalAllowancesAndReliefs"
      ],
      "additionalProperties": false
    },
    "incomeTaxCategoryObject": {
      "type": "object",
      "properties": {
        "totalAmount": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total amount of income tax relating to pay, pensions and profit"
        },
        "taxableIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Total amount of taxable income relating to pay, pensions and profit"
        },
        "band": {
          "$ref": "#/definitions/bandArray",
          "description": "An array of tax band data for pay, pensions and profit"
        }
      },
      "required": [
        "totalAmount",
        "taxableIncome",
        "band"
      ],
      "additionalProperties": false
    },
    "bandArray": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "description": "The name of the Tax band",
            "type": "string"
          },
          "rate": {
            "$ref": "#/definitions/percent",
            "description": "The Tax band rate expressed as a percentage"
          },
          "threshold": {
            "$ref": "#/definitions/wholePounds",
            "description": "The upper threshold of the band"
          },
          "apportionedThreshold": {
            "$ref": "#/definitions/wholePounds",
            "description": "The apportioned upper threshold of the band"
          },
          "income": {
            "$ref": "#/definitions/monetaryPos",
            "description": "Income attributed to the tax band"
          },
          "taxAmount": {
            "$ref": "#/definitions/monetaryPos",
            "description": "The calculated amount of income tax for the band (bandIncome x bandRate)"
          }
        },
        "required": [
          "name",
          "rate",
          "income",
          "taxAmount"
        ],
        "additionalProperties": false
      }
    },
    "allowancesAndReliefsObject": {
      "type": "object",
      "properties": {
        "deficiencyRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Deficiency Relief"
        },
        "topSlicingRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Top Slicing Relief"
        },
        "ventureCapitalTrustRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Venture Capital Trust relief"
        },
        "enterpriseInvestmentSchemeRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Enterprise Investment Scheme relief"
        },
        "seedEnterpriseInvestmentSchemeRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Seed Enterprise Investment Scheme relief"
        },
        "communityInvestmentTaxRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Community Investment Tax Relief"
        },
        "socialInvestmentTaxRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Social Investment Tax Relief"
        },
        "maintenanceAndAlimonyPaid": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Maintenance and alimony paid"
        },
        "marriedCoupleAllowanceRate": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Rate for Married Couple's Allowance"
        },
        "marriedCoupleAllowanceAmount": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Amount of Married Couple's Allowance"
        },
        "marriedCoupleAllowanceRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Relief on Married Couple's Allowance"
        },
        "surplusMarriedCoupleAllowanceAmount": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Amount of Surplus Married Couple's Allowance from spouse/partner"
        },
        "surplusMarriedCoupleAllowanceRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Relief on Surplus Married Couple's Allowance from spouse/partner"
        },
        "notionalTaxFromLifePolicies": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Notional tax from gains on life policies etc."
        },
        "notionalTaxFromDividendsAndOtherIncome": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Notional tax from stock dividends and other income"
        },
        "foreignTaxCreditRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Foreign Tax Credit Relief"
        },
        "propertyFinanceRelief": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Relief against property finance costs"
        }
      },
      "additionalProperties": false
    },
    "nicObject": {
      "type": "object",
      "properties": {
        "class2": {
          "$ref": "#/definitions/class2Object",
          "description": "An object relating to NIC Class 2 Calculation"
        },
        "class4": {
          "$ref": "#/definitions/class4Object",
          "description": "An object relating to NIC Class 4 Calculation"
        }
      },
      "required": [
        "class2",
        "class4"
      ],
      "additionalProperties": false
    },
    "class2Object": {
      "type": "object",
      "properties": {
        "amount": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Calculated amount of NIC Class 2"
        },
        "weekRate": {
          "$ref": "#/definitions/monetaryPos",
          "description": "The weekly rate"
        },
        "weeks": {
          "description": "the number of weeks applied in calculation",
          "type": "number"
        },
        "limit": {
          "$ref": "#/definitions/wholePounds",
          "description": "Annual limit for NIC Class 2"
        },
        "apportionedLimit": {
          "$ref": "#/definitions/wholePounds",
          "description": "Apportioned annual limit for NIC Class 2"
        }
      },
      "required": [
        "amount",
        "weekRate",
        "weeks",
        "limit",
        "apportionedLimit"
      ],
      "additionalProperties": false
    },
    "class4Object": {
      "type": "object",
      "properties": {
        "totalAmount": {
          "$ref": "#/definitions/monetaryPos",
          "description": "Calculated amount of NIC Class 4"
        },
        "band": {
          "$ref": "#/definitions/nic4BandArray",
          "description": "An array detailing bands relating to NIC Class 4"
        }
      },
      "required": [
        "totalAmount",
        "band"
      ],
      "additionalProperties": false
    },
    "msgArray": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "description": "Defines message type (INFO, WARN)",
            "type": "string"
          },
          "text": {
            "description": "message text",
            "type": "string"
          }
        },
        "required": [
          "type",
          "text"
        ],
        "additionalProperties": false
      }
    },
    "previousCalcObject": {
      "type": "object",
      "properties": {
        "calcTimestamp": {
          "$ref": "#/definitions/timestampString",
          "description": "The date and timestamp of when the previous calculation was performed"
        },
        "calcID": {
          "$ref": "#/definitions/calcId",
          "description": "The previous calculation ID"
        },
        "calcAmount": {
          "$ref": "#/definitions/monetaryPosNeg",
          "description": "The previous calculation for YTD income tax and national insurance"
        }
      },
      "required": [
        "calcTimestamp",
        "calcID",
        "calcAmount"
      ],
      "additionalProperties": false
    },
    "nic4BandArray": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "description": "The name of the Tax band",
            "type": "string"
          },
          "rate": {
            "$ref": "#/definitions/percent",
            "description": "The Tax band rate expressed as a percentage"
          },
          "threshold": {
            "$ref": "#/definitions/wholePounds",
            "description": "The upper threshold of the band"
          },
          "apportionedThreshold": {
            "$ref": "#/definitions/wholePounds",
            "description": "The apportioned upper threshold of the band"
          },
          "income": {
            "$ref": "#/definitions/monetaryPos",
            "description": "Income attributed to the tax band"
          },
          "amount": {
            "$ref": "#/definitions/monetaryPos",
            "description": "The calculated amount of income tax for the band (bandIncome x bandRate)"
          }
        },
        "required": [
          "name",
          "rate",
          "income",
          "amount"
        ],
        "additionalProperties": false
      }
    },
    "annualAllowancesObject": {
      "type": "object",
      "properties": {
        "personalAllowance": {
          "$ref": "#/definitions/wholePounds",
          "description": "The full Personal Allowance applicable to the Tax Year"
        },
        "reducedPersonalAllowanceThreshold": {
          "$ref": "#/definitions/wholePounds",
          "description": "The income threshold at which the Personal Allowance is reduced"
        },
        "reducedPersonalisedAllowance": {
          "$ref": "#/definitions/wholePounds",
          "description": "Reduced annual personal allowance if annual (or estimated annual) income exceeds the income threshold. Estimated annual income will be used for non-finalised calculations"
        }
      },
      "required": [
        "personalAllowance"
      ],
      "additionalProperties": false
    },
    "eoyEstimateObject": {
      "type": "object",
      "properties": {
        "incomeSource": {
          "$ref": "#/definitions/eoyEstimateIncomeSourceArray",
          "description": "An array of income sources"
        },
        "totalTaxableIncome": {
          "$ref": "#/definitions/wholePounds",
          "description": "Sum of estimated taxable income for all income sources"
        },
        "incomeTaxAmount": {
          "$ref": "#/definitions/wholePounds",
          "description": "Calculated Income tax amount from estimated taxable income"
        },
        "nic2": {
          "$ref": "#/definitions/wholePounds",
          "description": "Calculated NIC Class 2 from estimates"
        },
        "nic4": {
          "$ref": "#/definitions/wholePounds",
          "description": "Calculated NIC Class 4 from estimates"
        },
        "totalNicAmount": {
          "$ref": "#/definitions/wholePounds",
          "description": "Sum of National Insurance amounts"
        },
        "incomeTaxNicAmount": {
          "$ref": "#/definitions/wholePounds",
          "description": "Total of calculated Income Tax and National Insurance from estimated annual taxable income"
        }
      },
      "required": [
        "incomeSource",
        "totalTaxableIncome",
        "incomeTaxAmount",
        "nic2",
        "nic4",
        "totalNicAmount",
        "incomeTaxNicAmount"
      ],
      "additionalProperties": false
    },
    "eoyEstimateIncomeSourceArray": {
      "description": "An array of annualised estimated income by income source",
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "description": "The Income Source ID",
            "type": "string"
          },
          "type": {
            "description": "Indicates the income source type. Values are: 01=Employment; 02=Share schemes; 03=Self-Employment; 04=Partnership; 05=UK Land and Property;06=Foreign income; 07=Dividends from foreign companies; 08=Trusts and Estates; 09=Interest from UK banks, building societies and securities etc; 10=Dividends from UK companies; 11=UK pensions and state benefits; 12=Gains on life insurance policies etc.",
            "type": "string",
            "pattern": "^[0-9]{2}$"
          },
          "taxableIncome": {
            "$ref": "#/definitions/wholePounds",
            "description": "Estimated taxable income for source"
          },
          "supplied": {
            "description": "Indicates if the estimate taxable income is supplied by the taxpayer (true) or calculated (false)",
            "type": "boolean"
          },
          "finalised": {
            "description": "Indicates if the income source has been finalised for the tax year (only applies to self-employment and UK Property income types)",
            "type": "boolean"
          }
        },
        "required": [
          "id",
          "type",
          "taxableIncome",
          "supplied"
        ],
        "additionalProperties": false
      }
    },
    "calcId": {
      "description": "The calculation ID – an 8 digit number with leading zeros that is unique to the identifier in the calculation input",
      "type": "string",
      "minLength": 8,
      "maxLength": 8,
      "pattern": "^[0-9]{8}$"
    },
    "dateString": {
      "description": "YYYY-MM-DD",
      "type": "string",
      "pattern": "^\\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$"
    },
    "timestampString": {
      "description": "Standard timestamp format",
      "type": "string",
      "format": "date-time"
    },
    "wholePounds": {
      "description": "Defines amounts given in whole pounds between 0.00 and 99.99",
      "type": "number",
      "minimum": 0,
      "maximum": 99999999,
      "multipleOf": 1
    },
    "monetaryPos": {
      "description": "Defines a monetary value (to 2 decimal places), between 0 and 99,999,999.99",
      "type": "number",
      "minimum": 0.0,
      "maximum": 99999999.99,
      "multipleOf": 0.01
    },
    "monetaryNeg": {
      "description": "Defines a monetary value (to 2 decimal places), between -99,999,999.99 and 0",
      "type": "number",
      "minimum": -99999999.99,
      "maximum": 0,
      "multipleOf": 0.01
    },
    "monetaryPosNeg": {
      "description": "Defines a monetary value (to 2 decimal places), between -99,999,999.99 and 99,999,999.99",
      "type": "number",
      "minimum": -99999999.99,
      "maximum": 99999999.99,
      "multipleOf": 0.01
    },
    "percent": {
      "description": "Defines a percentage rate (to 2 decimal places), between 0.00 and 99.99",
      "type": "number",
      "minimum": 0.0,
      "maximum": 99.99,
      "multipleOf": 0.01
    }
  }
}